<br>
<p><span style="font-family: Arial, Helvetica, sans-serif; color: rgb(166, 10, 8); font-size: 22px;">Calculator</span></p>
<br>
<div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="font-weight: bold">import</span> <span style="font-weight: bold">org.json.JSONObject</span>;

<span style="font-weight: bold">import</span> <span style="font-weight: bold">java.io.FileWriter</span>;

<span style="font-weight: bold">public</span> <span style="font-weight: bold">class</span> <span style="font-weight: bold">JSONConfiguration</span> {
    <span style="font-weight: bold">public</span> <span style="font-weight: bold">static</span> <span style="font-weight: bold">void</span> main(String... args) {
        JSONConfiguration jsonConfiguration = <span style="font-weight: bold">new</span> JSONConfiguration();
        jsonConfiguration.build(<span style="font-style: italic">&quot;scientific&quot;</span>);
    }

    <span style="font-weight: bold">public</span> <span style="font-weight: bold">void</span> build(String calculatorType) {
        <span style="font-weight: bold">try</span> {
            JSONObject jsonObject = <span style="font-weight: bold">new</span> JSONObject();

            <span style="font-weight: bold">switch</span> (calculatorType) {
                <span style="font-weight: bold">case</span> <span style="font-style: italic">&quot;normal&quot;</span> -&gt; jsonObject.put(<span style="font-style: italic">&quot;calculator_type&quot;</span>, <span style="font-style: italic">&quot;normal&quot;</span>);
                <span style="font-weight: bold">case</span> <span style="font-style: italic">&quot;extended&quot;</span> -&gt; jsonObject.put(<span style="font-style: italic">&quot;calculator_type&quot;</span>, <span style="font-style: italic">&quot;extended&quot;</span>);
                <span style="font-weight: bold">case</span> <span style="font-style: italic">&quot;scientific&quot;</span> -&gt; jsonObject.put(<span style="font-style: italic">&quot;calculator_type&quot;</span>, <span style="font-style: italic">&quot;scientific&quot;</span>);
                <span style="font-weight: bold">default</span> -&gt; jsonObject.put(<span style="font-style: italic">&quot;calculator_type&quot;</span>, <span style="font-style: italic">&quot;invalid&quot;</span>);
            }

            FileWriter fileWriter = <span style="font-weight: bold">new</span> FileWriter(<span style="font-style: italic">&quot;calculator.json&quot;</span>);
            fileWriter.write(jsonObject.toString());
            fileWriter.close();
        } <span style="font-weight: bold">catch</span> (Exception e) {
            System.out.println(e.getMessage());
        }
    }
}
</pre></div>
<br>
<div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="font-weight: bold">public</span> <span style="font-weight: bold">enum</span> CalculatorType {
    NORMAL, EXTENDED, SCIENTIFIC
}
</pre></div>
<br>
<div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="font-weight: bold">import</span> <span style="font-weight: bold">org.json.JSONObject</span>;
<span style="font-weight: bold">import</span> <span style="font-weight: bold">org.json.JSONTokener</span>;

<span style="font-weight: bold">import</span> <span style="font-weight: bold">java.io.FileReader</span>;

<span style="font-weight: bold">public</span> <span style="font-weight: bold">enum</span> Configuration {
    instance;

    <span style="font-weight: bold">public</span> <span style="font-weight: bold">final</span> String userDirectory = System.getProperty(<span style="font-style: italic">&quot;user.dir&quot;</span>);
    <span style="font-weight: bold">public</span> <span style="font-weight: bold">final</span> String fileSeparator = System.getProperty(<span style="font-style: italic">&quot;file.separator&quot;</span>);
    <span style="font-weight: bold">public</span> <span style="font-weight: bold">final</span> String pathToJavaArchive = userDirectory + fileSeparator + getCalculatorType() + fileSeparator + <span style="font-style: italic">&quot;jar&quot;</span> + fileSeparator + <span style="font-style: italic">&quot;calculator.jar&quot;</span>;

    <span style="font-weight: bold">public</span> CalculatorType getCalculatorType() {
        <span style="font-weight: bold">try</span> {
            FileReader fileReader = <span style="font-weight: bold">new</span> FileReader(<span style="font-style: italic">&quot;calculator.json&quot;</span>);
            JSONTokener jsonTokener = <span style="font-weight: bold">new</span> JSONTokener(fileReader);
            JSONObject jsonObject = <span style="font-weight: bold">new</span> JSONObject(jsonTokener);
            fileReader.close();
            <span style="font-weight: bold">return</span> CalculatorType.valueOf(jsonObject.getString(<span style="font-style: italic">&quot;calculator_type&quot;</span>).toUpperCase());
        } <span style="font-weight: bold">catch</span> (Exception e) {
            System.out.println(e.getMessage());
        }

        <span style="font-weight: bold">return</span> <span style="font-weight: bold">null</span>;
    }
}
</pre></div>
<br>
<div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="font-weight: bold">import</span> <span style="font-weight: bold">java.io.File</span>;
<span style="font-weight: bold">import</span> <span style="font-weight: bold">java.lang.reflect.Method</span>;
<span style="font-weight: bold">import</span> <span style="font-weight: bold">java.net.URL</span>;
<span style="font-weight: bold">import</span> <span style="font-weight: bold">java.net.URLClassLoader</span>;

<span style="font-weight: bold">public</span> <span style="font-weight: bold">class</span> <span style="font-weight: bold">Application</span> {
    <span style="font-weight: bold">private</span> Object port;

    <span style="font-weight: bold">public</span> <span style="font-weight: bold">static</span> <span style="font-weight: bold">void</span> main(String... args) {
        Configuration.instance.getCalculatorType();
        Application application = <span style="font-weight: bold">new</span> Application();
        application.createCalculatorPortInstance();
        System.out.println(<span style="font-style: italic">&quot;5 + 3     | &quot;</span> + application.execute(5, 3, <span style="font-style: italic">&quot;add&quot;</span>));
        System.out.println(<span style="font-style: italic">&quot;5 - 3     | &quot;</span> + application.execute(5, 3, <span style="font-style: italic">&quot;subtract&quot;</span>));
        System.out.println(<span style="font-style: italic">&quot;5 * 3     | &quot;</span> + application.execute(5, 3, <span style="font-style: italic">&quot;multiply&quot;</span>));
        System.out.println(<span style="font-style: italic">&quot;3 (prime) | &quot;</span> + application.isPrime(<span style="font-style: italic">&quot;3&quot;</span>));
    }

    @SuppressWarnings(<span style="font-style: italic">&quot;unchecked&quot;</span>)
    <span style="font-weight: bold">public</span> <span style="font-weight: bold">void</span> createCalculatorPortInstance() {
        Object instance;

        <span style="font-weight: bold">try</span> {
            System.out.println(<span style="font-style: italic">&quot;pathToJar | &quot;</span> + Configuration.instance.pathToJavaArchive);
            URL[] urls = {<span style="font-weight: bold">new</span> File(Configuration.instance.pathToJavaArchive).toURI().toURL()};
            URLClassLoader urlClassLoader = <span style="font-weight: bold">new</span> URLClassLoader(urls, Application.class.getClassLoader());
            Class clazz = Class.forName(<span style="font-style: italic">&quot;Calculator&quot;</span>, <span style="font-weight: bold">true</span>, urlClassLoader);
            System.out.println(<span style="font-style: italic">&quot;clazz     | &quot;</span> + clazz);

            instance = clazz.getMethod(<span style="font-style: italic">&quot;getInstance&quot;</span>).invoke(<span style="font-weight: bold">null</span>);
            port = clazz.getDeclaredField(<span style="font-style: italic">&quot;port&quot;</span>).get(instance);
            System.out.println(<span style="font-style: italic">&quot;port      | &quot;</span> + port.hashCode());

            Method getVersion = port.getClass().getMethod(<span style="font-style: italic">&quot;getVersion&quot;</span>);
            String version = (String) getVersion.invoke(port);
            System.out.println(<span style="font-style: italic">&quot;version   | &quot;</span> + version);
        } <span style="font-weight: bold">catch</span> (Exception e) {
            System.out.println(<span style="font-style: italic">&quot;--- exception&quot;</span>);
            System.out.println(e.getMessage());
        }
    }

    <span style="font-weight: bold">public</span> <span style="font-weight: bold">int</span> execute(<span style="font-weight: bold">int</span> a, <span style="font-weight: bold">int</span> b, String operation) {
        <span style="font-weight: bold">int</span> result = Integer.MAX_VALUE;

        <span style="font-weight: bold">try</span> {
            Method method = port.getClass().getMethod(operation, <span style="font-weight: bold">int</span>.class, <span style="font-weight: bold">int</span>.class);
            result = (Integer) method.invoke(port, a, b);
        } <span style="font-weight: bold">catch</span> (Exception e) {
            System.out.println(<span style="font-style: italic">&quot;operation &quot;</span> + operation + <span style="font-style: italic">&quot; not supported.&quot;</span>);
        }

        <span style="font-weight: bold">return</span> result;
    }

    <span style="font-weight: bold">public</span> <span style="font-weight: bold">boolean</span> isPrime(String string) {
        <span style="font-weight: bold">boolean</span> result = <span style="font-weight: bold">false</span>;

        <span style="font-weight: bold">try</span> {
            Method method = port.getClass().getMethod(<span style="font-style: italic">&quot;isPrime&quot;</span>, String.class);
            result = (Boolean) method.invoke(port, string);
        } <span style="font-weight: bold">catch</span> (Exception e) {
            System.out.println(<span style="font-style: italic">&quot;operation isPrime not supported.&quot;</span>);
        }

        <span style="font-weight: bold">return</span> result;
    }
}
</pre></div>
<br>
<div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%">{&quot;calculator_type&quot;:&quot;scientific&quot;}
</pre></div>
<br>
<div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%">plugins {
    id &#39;java&#39;
}

group &#39;dhbw&#39;

repositories {
    mavenCentral()
}

dependencies {
    implementation group: &#39;org.json&#39;, name: &#39;json&#39;, version: &#39;20211205&#39;
}

allprojects {
    gradle.projectsEvaluated {
        tasks.withType(JavaCompile) {
            options.compilerArgs <span style="border: 1px solid #FF0000">&lt;&lt;</span> &quot;-Xlint:unchecked&quot;
        }
    }
}
</pre></div>
<br>
<p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 11px;">Prof. Dr. Carsten M&uuml;ller <span style="color: rgb(166, 10, 8);">|</span> Software Engineering</span></p>