<br>
<p><span style="font-family: Arial, Helvetica, sans-serif; color: rgb(166, 10, 8); font-size: 22px;">Bitcoin | Address</span></p>
<br>
<div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="font-weight: bold">public</span> <span style="font-weight: bold">enum</span> Configuration {
    instance;

    <span style="font-weight: bold">public</span> <span style="font-weight: bold">final</span> <span style="font-weight: bold">char</span>[] ALPHABET = <span style="font-style: italic">&quot;123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz&quot;</span>.toCharArray();
    <span style="font-weight: bold">public</span> <span style="font-weight: bold">final</span> <span style="font-weight: bold">char</span> ENCODED_ZERO = ALPHABET[0];
    <span style="font-weight: bold">public</span> <span style="font-weight: bold">final</span> <span style="font-weight: bold">int</span>[] INDEXES = <span style="font-weight: bold">new</span> <span style="font-weight: bold">int</span>[128];

    <span style="font-weight: bold">public</span> <span style="font-weight: bold">final</span> String EC_GENERATOR_SPECIFICATION_ALGORITHM = <span style="font-style: italic">&quot;secp256r1&quot;</span>;
    <span style="font-weight: bold">public</span> <span style="font-weight: bold">final</span> String MESSAGE_DIGEST_SHA_ALGORITHM = <span style="font-style: italic">&quot;SHA-256&quot;</span>;
    <span style="font-weight: bold">public</span> <span style="font-weight: bold">final</span> String MESSAGE_DIGEST_MD5_ALGORITHM = <span style="font-style: italic">&quot;MD5&quot;</span>;
}
</pre></div>
<br>
<div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="font-weight: bold">import</span> <span style="font-weight: bold">java.util.Arrays</span>;

<span style="font-weight: bold">public</span> <span style="font-weight: bold">class</span> <span style="font-weight: bold">Base58</span> {
    <span style="font-weight: bold">static</span> {
        Arrays.fill(Configuration.instance.INDEXES, -1);
        <span style="font-weight: bold">for</span> (<span style="font-weight: bold">int</span> i = 0; i &lt; Configuration.instance.ALPHABET.length; i++) {
            Configuration.instance.INDEXES[Configuration.instance.ALPHABET[i]] = i;
        }
    }

    <span style="font-weight: bold">public</span> <span style="font-weight: bold">static</span> String encode(<span style="font-weight: bold">byte</span>[] input) {
        <span style="font-weight: bold">if</span> (input.length == 0) {
            <span style="font-weight: bold">return</span> <span style="font-style: italic">&quot;&quot;</span>;
        }

        <span style="font-weight: bold">int</span> zeros = 0;
        <span style="font-weight: bold">while</span> (zeros &lt; input.length &amp;&amp; input[zeros] == 0) {
            ++zeros;
        }

        input = Arrays.copyOf(input, input.length);
        <span style="font-weight: bold">char</span>[] encoded = <span style="font-weight: bold">new</span> <span style="font-weight: bold">char</span>[input.length * 2];
        <span style="font-weight: bold">int</span> outputStart = encoded.length;
        <span style="font-weight: bold">for</span> (<span style="font-weight: bold">int</span> inputStart = zeros; inputStart &lt; input.length; ) {
            encoded[--outputStart] = Configuration.instance.ALPHABET[divMod(input, inputStart)];
            <span style="font-weight: bold">if</span> (input[inputStart] == 0) {
                ++inputStart;
            }
        }

        <span style="font-weight: bold">while</span> (outputStart &lt; encoded.length &amp;&amp; encoded[outputStart] == Configuration.instance.ENCODED_ZERO) {
            ++outputStart;
        }

        <span style="font-weight: bold">while</span> (--zeros &gt;= 0) {
            encoded[--outputStart] = Configuration.instance.ENCODED_ZERO;
        }

        <span style="font-weight: bold">return</span> <span style="font-weight: bold">new</span> String(encoded, outputStart, encoded.length - outputStart);
    }

    <span style="font-weight: bold">private</span> <span style="font-weight: bold">static</span> <span style="font-weight: bold">byte</span> divMod(<span style="font-weight: bold">byte</span>[] number, <span style="font-weight: bold">int</span> firstDigit) {
        <span style="font-weight: bold">int</span> remainder = 0;

        <span style="font-weight: bold">for</span> (<span style="font-weight: bold">int</span> i = firstDigit; i &lt; number.length; i++) {
            <span style="font-weight: bold">int</span> digit = (<span style="font-weight: bold">int</span>) number[i] &amp; 0xFF;
            <span style="font-weight: bold">int</span> temp = remainder * 256 + digit;
            number[i] = (<span style="font-weight: bold">byte</span>) (temp / 58);
            remainder = temp % 58;
        }

        <span style="font-weight: bold">return</span> (<span style="font-weight: bold">byte</span>) remainder;
    }
}
</pre></div>
<br>
<div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="font-weight: bold">import</span> <span style="font-weight: bold">java.nio.charset.StandardCharsets</span>;
<span style="font-weight: bold">import</span> <span style="font-weight: bold">java.security.*</span>;
<span style="font-weight: bold">import</span> <span style="font-weight: bold">java.security.interfaces.ECPrivateKey</span>;
<span style="font-weight: bold">import</span> <span style="font-weight: bold">java.security.interfaces.ECPublicKey</span>;
<span style="font-weight: bold">import</span> <span style="font-weight: bold">java.security.spec.ECGenParameterSpec</span>;
<span style="font-weight: bold">import</span> <span style="font-weight: bold">java.security.spec.ECPoint</span>;

<span style="font-weight: bold">public</span> <span style="font-weight: bold">class</span> <span style="font-weight: bold">Application</span> {
    <span style="font-weight: bold">public</span> <span style="font-weight: bold">static</span> <span style="font-weight: bold">void</span> main(String... args) {
        Application application = <span style="font-weight: bold">new</span> Application();
        application.generateKeys();
    }

    <span style="font-weight: bold">private</span> String adjustTo64(String string) {
        <span style="font-weight: bold">return</span> switch (string.length()) {
            <span style="font-weight: bold">case</span> 62 -&gt; <span style="font-style: italic">&quot;00&quot;</span> + string;
            <span style="font-weight: bold">case</span> 63 -&gt; <span style="font-style: italic">&quot;0&quot;</span> + string;
            <span style="font-weight: bold">case</span> 64 -&gt; string;
            <span style="font-weight: bold">default</span> -&gt; <span style="font-weight: bold">throw</span> <span style="font-weight: bold">new</span> IllegalArgumentException(<span style="font-style: italic">&quot;not a valid key | &quot;</span> + string);
        };
    }

    <span style="font-weight: bold">public</span> String bytesToHex(<span style="font-weight: bold">byte</span>[] bytes) {
        <span style="font-weight: bold">byte</span>[] hexArray = <span style="font-style: italic">&quot;0123456789ABCDEF&quot;</span>.getBytes(StandardCharsets.US_ASCII);
        <span style="font-weight: bold">byte</span>[] hexChars = <span style="font-weight: bold">new</span> <span style="font-weight: bold">byte</span>[bytes.length * 2];

        <span style="font-weight: bold">for</span> (<span style="font-weight: bold">int</span> j = 0; j &lt; bytes.length; j++) {
            <span style="font-weight: bold">int</span> v = bytes[j] &amp; 0xFF;
            hexChars[j * 2] = hexArray[v &gt;&gt;&gt; 4];
            hexChars[j * 2 + 1] = hexArray[v &amp; 0x0F];
        }

        <span style="font-weight: bold">return</span> <span style="font-weight: bold">new</span> String(hexChars, StandardCharsets.UTF_8);
    }

    <span style="font-weight: bold">public</span> <span style="font-weight: bold">void</span> generateKeys() {
        <span style="font-weight: bold">try</span> {
            KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(<span style="font-style: italic">&quot;EC&quot;</span>);
            ECGenParameterSpec ecGeneratorParameterSpecification = <span style="font-weight: bold">new</span> ECGenParameterSpec(Configuration.instance.EC_GENERATOR_SPECIFICATION_ALGORITHM);

            keyPairGenerator.initialize(ecGeneratorParameterSpecification);
            KeyPair keyPair = keyPairGenerator.generateKeyPair();

            PublicKey publicKey = keyPair.getPublic();
            PrivateKey privateKey = keyPair.getPrivate();

            ECPrivateKey ecPrivateKey = (ECPrivateKey) privateKey;
            String result = adjustTo64(ecPrivateKey.getS().toString(16)).toUpperCase();
            System.out.println(<span style="font-style: italic">&quot;s[&quot;</span> + result.length() + <span style="font-style: italic">&quot;] (stored in wallet) | &quot;</span> + result);
            ECPublicKey ecPublicKey = (ECPublicKey) publicKey;
            ECPoint ecPoint = ecPublicKey.getW();
            String sx = adjustTo64(ecPoint.getAffineX().toString(16)).toUpperCase();
            String sy = adjustTo64(ecPoint.getAffineY().toString(16)).toUpperCase();
            String bcPublicKey = <span style="font-style: italic">&quot;04&quot;</span> + sx + sy;
            System.out.println(<span style="font-style: italic">&quot;bcPublicKey              | &quot;</span> + bcPublicKey);

            MessageDigest shaMessageDigest01 = MessageDigest.getInstance(Configuration.instance.MESSAGE_DIGEST_SHA_ALGORITHM);
            <span style="font-weight: bold">byte</span>[] resultSHAMessageDigest = shaMessageDigest01.digest(bcPublicKey.getBytes(StandardCharsets.UTF_8));
            System.out.println(<span style="font-style: italic">&quot;shaMessageDigest01       | &quot;</span> + bytesToHex(resultSHAMessageDigest).toUpperCase());

            MessageDigest md5MessageDigest01 = MessageDigest.getInstance(Configuration.instance.MESSAGE_DIGEST_MD5_ALGORITHM);
            <span style="font-weight: bold">byte</span>[] md5MessageDigest02 = md5MessageDigest01.digest(resultSHAMessageDigest);
            <span style="font-weight: bold">byte</span>[] md5MessageDigest03 = <span style="font-weight: bold">new</span> <span style="font-weight: bold">byte</span>[md5MessageDigest02.length + 1];
            md5MessageDigest03[0] = 0;
            System.arraycopy(md5MessageDigest02, 0, md5MessageDigest03, 1, md5MessageDigest02.length);
            System.out.println(<span style="font-style: italic">&quot;md5MessageDigest01       | &quot;</span> + bytesToHex(md5MessageDigest03).toUpperCase());

            <span style="font-weight: bold">byte</span>[] shaMessageDigest02 = shaMessageDigest01.digest(md5MessageDigest03);
            System.out.println(<span style="font-style: italic">&quot;shaMessageDigest02       | &quot;</span> + bytesToHex(shaMessageDigest02).toUpperCase());

            <span style="font-weight: bold">byte</span>[] shaMessageDigest03 = shaMessageDigest01.digest(shaMessageDigest02);
            System.out.println(<span style="font-style: italic">&quot;shaMessageDigest03       | &quot;</span> + bytesToHex(shaMessageDigest03).toUpperCase());

            <span style="font-weight: bold">byte</span>[] temp = <span style="font-weight: bold">new</span> <span style="font-weight: bold">byte</span>[25];
            System.arraycopy(md5MessageDigest02, 0, temp, 0, md5MessageDigest02.length);
            System.arraycopy(shaMessageDigest03, 0, temp, 20, 5);
            System.out.println(<span style="font-style: italic">&quot;transaction address      | &quot;</span> + Base58.encode(temp));
        } <span style="font-weight: bold">catch</span> (Exception e) {
            System.out.println(e.getMessage());
        }
    }
}
</pre></div>
<br>
<p><span style="font-family: Arial, Helvetica, sans-serif; font-size: 11px;">Prof. Dr. Carsten M&uuml;ller <span style="color: rgb(166, 10, 8);">|</span> Kryptographie</span></p>